---
title: pycharm远程调试
date: 2019-04-27 08:00:34
tags:
- python 
- coding-tools
categories:
- coding-tools
---

{%note info%}
pycharm是目前python开发者中最受欢迎的IDE，今天来介绍它的远程调试功能。
请注意文中介绍的所有功能仅出现在pycharm专业版版中。
{%endnote%}
<!--more-->

## 前置
- `File`->`Settings`->`Project`->`Project Interpreter`->`add`
- 配置mapping，本地代码与远程代码的映射，`此步骤是必须的`，方式可以通过挂载或者Tool->Configure->SFTP
- Interpreter设置完后请确认`External Libraries`->`Remote Libraries`生成，若未出现，重启pycharm或许有奇迹

## SSL Interpreter
![pycharm.ssh.png](https://i.loli.net/2019/05/04/5ccd05b56616c.png)

这里需要注意远程的运行环境必须是venv|virtualenv，若使用conda将导致无法获取`Remote Libraries`，从而无法远程debug
## Docker
- 开启docker守护进程的API调用
- mapping需要另外挂载
![pycharm.docker.png](https://i.loli.net/2019/05/04/5ccd06162dfdb.png)

## Docker Compose（推荐）
- mapping挂载可以直接在compose文件中指定
- 镜像建议通过image，若为build将会每次都重新构建
![pycharm.docker-compose.png](https://i.loli.net/2019/05/04/5ccd0605cbe19.png)

```
version: "3"
services:

  centos:
    # build:
    #   context: .
    #   dockerfile: Dockerfile.centos
    image: zipee/centos:latest
    command: sh
    volumes:
      - E:\code\python3\:/var/www/
    ports:
      - "5000:5000"
    links:
      - redis

  redis:
    image: "redis:alpine"
    ports:
      - "6379:6379"

```

## celery remote-debug

由于celery将不再支持windows，所以celery的调试就比较麻烦，有了远程调试后这个问题就迎刃而解

简单的celery代码如下：
```
from celery import Celery

app = Celery('simple', broker='redis://redis:6379/0')

@app.task()
def add(x, y):
    return x + y
```

配置celery的启动命令：
![pycharm.celery.png](https://i.loli.net/2019/05/04/5ccd0ebb7816c.png)

使用了docker作为python远程解释器，甚至本地都无需安装python，使用起来简直不要太优雅！